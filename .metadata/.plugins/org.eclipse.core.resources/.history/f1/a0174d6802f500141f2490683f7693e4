package crud;

import java.sql.*;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.HashSet;
import java.util.Map.Entry;
import java.util.Set;

public class MySQLCreator extends DBCreator {

	Connection con;
	
	public void initConnection(String dbName){
		try {
			con = DriverManager.getConnection("jdbc:mysql://127.0.0.1:3306/"+ dbName 
					+ "?user=root&password=password");

		} catch (Exception e) {
			e.printStackTrace();
		}
	}
	
	public void createTable(String tableName, HashMap<String,String> columns, String primaryKey){
		try{
			Statement create = con.createStatement();
			
			String createStatement = "CREATE TABLE" + tableName + "(";
			
			Set<Entry<String,String>> columnPairs = columns.entrySet();
			
			for(Entry<String,String> pair : columnPairs){
				createStatement += pair.getKey() + " " + pair.getValue() + " NOT NULL,";
			}
			
			createStatement += "PRIMARY KEY (" + primaryKey + "));";
			
			create.execute(createStatement);
		}
		catch(Exception e){
			
		}
	}
	
	public void addRow(String tableName, ArrayList<Object> values){
		
	}
	
}
